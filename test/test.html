<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/> 
	<title>test</title>
</head>
<body>
	<p id="a" style="background: red;"></p>
	<ul id="table"></ul>
	<script type="text/javascript" src="./jquery.min.js"></script>
	<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.1.0.js"></script>
	<script type="text/javascript">
		$.get('/api', function(data){
			var config = {
		    debug: true, 
		    appId: 'wxd3248bc1a7edaab3', 
		    timestamp: Number(data.timestamp), 
		    nonceStr: data.noncestr, 
		    signature: data.signature,
		    jsApiList: ['startSearchBeacons', 'stopSearchBeacons', 'onSearchBeacons'] 
			}

			wx.config(config);
			wx.ready(function(){

				wx.startSearchBeacons({
					complete:function(argv){
						$('#a').html(JSON.stringify(argv));

						wx.onSearchBeacons({
							complete:function(argv){
								var b = argv['beacons'];
								for(var i=0; i<b.length; i++){
									$('#table').append('<li id="d'+ i +'"></li>')
									var str = 'accuracy:' + b[i].accuracy + ' rssi:' + b[i].rssi + ' proximity:' + b[i].proximity;
									$('#d'+i).html(str);
								}
								JSON.stringify(argv)

							}
						});

					}
				});
			});
		});



	</script>
</body>
</html>